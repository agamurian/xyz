import{w as _,d as P,_ as b}from"./preload-helper-159545b2.js";import{V as s}from"./index-c254349b.js";var le=Object.defineProperty,ie=Object.defineProperties,se=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,B=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,F=(r,e,t)=>e in r?le(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,u=(r,e)=>{for(var t in e||(e={}))B.call(e,t)&&F(r,t,e[t]);if(E)for(var t of E(e))U.call(e,t)&&F(r,t,e[t]);return r},h=(r,e)=>ie(r,se(e)),D=(r,e)=>{var t={};for(var a in r)B.call(r,a)&&e.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&E)for(var a of E(r))e.indexOf(a)<0&&U.call(r,a)&&(t[a]=r[a]);return t},N=({parser:r,key:e,params:t,translations:a,locale:o,fallbackLocale:l})=>{if(!(e&&o))return console.warn("[i18n]: No translation key or locale provided. Skipping translation..."),"";let i=(a[o]||{})[e];return l&&i===void 0&&(i=(a[l]||{})[e]),r.parse(i,t,o,e)},f=(...r)=>r.length?r.filter(e=>!!e).map(e=>{let t=`${e}`.toLowerCase();try{[t]=Intl.Collator.supportedLocalesOf(e)}catch{console.warn(`[i18n]: Non-standard locale provided: '${r}'. Check your 'translations' and 'loaders' in i18n config...`)}return t}):[],I=(r,e)=>Object.keys(r||{}).reduce((t,a)=>{let o=r[a],l=e?`${e}.${a}`:`${a}`;return o&&typeof o=="object"?u(u({},t),I(o,l)):h(u({},t),{[l]:o})},{}),ne=async r=>{try{return(await Promise.all(r.map(e=>{var t=e,{loader:a}=t,o=D(t,["loader"]);return new Promise(async l=>{let i;try{i=await a()}catch(n){console.error(`[i18n]: Failed to load translation. Verify your '${o.locale}' > '${o.key}' Loader.`),console.error(n)}l(h(u({loader:a},o),{data:i}))})}))).reduce((e,{key:t,data:a,locale:o})=>{if(!a)return e;let[l]=f(o);return h(u({},e),{[l]:I(h(u({},e[l]||{}),{[t]:a}))})},{})}catch(e){console.error(e)}return{}},ce=r=>e=>{try{if(typeof e=="string")return e===r;if(typeof e=="object")return e.test(r)}catch{throw new Error("[i18n]: Invalid route config!")}return!1},ue=(r,e)=>{let t=!0;try{t=Object.keys(r).filter(a=>r[a]!==void 0).every(a=>r[a]===e[a])}catch{}return t},K=1e3*60*60*24,de=class{constructor(r){this.cachedAt=0,this.loadedKeys={},this.currentRoute=_(),this.config=_(),this.isLoading=_(!1),this.promises=new Set,this.loading={subscribe:this.isLoading.subscribe,toPromise:(e,t)=>{let a=Array.from(this.promises).filter(o=>ue({locale:f(e)[0],route:t},o)).map(({promise:o})=>o);return Promise.all(a)},get:()=>s(this.isLoading)},this.privateTranslations=_({}),this.translations={subscribe:this.privateTranslations.subscribe,get:()=>s(this.translations)},this.locales=h(u({},P([this.config,this.privateTranslations],([e,t])=>{if(!e)return[];let{loaders:a=[]}=e,o=a.map(({locale:i})=>f(i)[0]),l=Object.keys(t).map(i=>f(i)[0]);return Array.from(new Set([...o,...l]))},[])),{get:()=>s(this.locales)}),this.internalLocale=_(),this.loaderTrigger=P([this.internalLocale,this.currentRoute],([e,t],a)=>{var o,l,i;e!==void 0&&t!==void 0&&(e!==((o=s(this.loaderTrigger))==null?void 0:o[0])||t!==((l=s(this.loaderTrigger))==null?void 0:l[1]))&&((i=s(this.config))!=null&&i.debug&&console.debug("[i18n]: Triggering translation load..."),a([e,t]))},[]),this.localeHelper=_(),this.locale={subscribe:this.localeHelper.subscribe,forceSet:this.localeHelper.set,set:this.internalLocale.set,update:this.internalLocale.update,get:()=>s(this.locale)},this.initialized=P([this.locale,this.currentRoute,this.privateTranslations],([e,t,a],o)=>{s(this.initialized)||o(e!==void 0&&t!==void 0&&!!Object.keys(a).length)}),this.translation=P([this.privateTranslations,this.locale,this.isLoading],([e,t,a],o)=>{let l=e[t];l&&Object.keys(l).length&&!a&&o(l)},{}),this.t=h(u({},P([this.config,this.translation],([{parser:e,fallbackLocale:t}])=>(a,...o)=>N({parser:e,key:a,params:o,translations:this.translations.get(),locale:this.locale.get(),fallbackLocale:t}))),{get:(e,...t)=>s(this.t)(e,...t)}),this.l=h(u({},P([this.config,this.translations],([{parser:e,fallbackLocale:t},a])=>(o,l,...i)=>N({parser:e,key:l,params:i,translations:a,locale:o,fallbackLocale:t}))),{get:(e,t,...a)=>s(this.l)(e,t,...a)}),this.getLocale=e=>{if(!e)return"";let t=this.locales.get().find(a=>a===f(e)[0])||"";return f(t)[0]||""},this.setLocale=e=>{var t;if(!e)return;let[a]=f(e);if(a!==s(this.internalLocale))return(t=s(this.config))!=null&&t.debug&&console.debug(`[i18n]: Setting '${a}' locale.`),this.internalLocale.set(a),this.loading.toPromise(e,s(this.currentRoute))},this.setRoute=e=>{var t;if(e!==s(this.currentRoute)){(t=s(this.config))!=null&&t.debug&&console.debug(`[i18n]: Setting '${e}' route.`),this.currentRoute.set(e);let a=s(this.internalLocale);return this.loading.toPromise(a,e)}},this.loadConfig=async e=>{await this.configLoader(e)},this.getTranslationProps=async(e=this.locale.get(),t=s(this.currentRoute))=>{let a=s(this.config);if(!a||!e)return[];let o=this.translations.get(),{loaders:l,fallbackLocale:i="",cache:n=K}=a||{},p=Number.isNaN(+n)?K:+n;this.cachedAt?Date.now()>p+this.cachedAt&&(a!=null&&a.debug&&console.debug("[i18n]: Refreshing cache."),this.loadedKeys={},this.cachedAt=0):(a!=null&&a.debug&&console.debug("[i18n]: Setting cache timestamp."),this.cachedAt=Date.now());let[d,y]=f(e,i),T=o[d],L=o[y],k=(l||[]).map(c=>{var g=c,{locale:$}=g,m=D(g,["locale"]);return h(u({},m),{locale:f($)[0]})}).filter(({routes:c})=>!c||(c||[]).some(ce(t))).filter(({key:c,locale:g})=>g===d&&(!T||!(this.loadedKeys[d]||[]).includes(c))||i&&g===y&&(!L||!(this.loadedKeys[y]||[]).includes(c)));if(k.length){this.isLoading.set(!0),a!=null&&a.debug&&console.debug("[i18n]: Fetching translations...");let c=await ne(k);this.isLoading.set(!1);let g=Object.keys(c).reduce((m,v)=>h(u({},m),{[v]:Object.keys(c[v])}),{}),$=k.filter(({key:m,locale:v})=>(g[v]||[]).some(w=>`${w}`.startsWith(m))).reduce((m,{key:v,locale:w})=>h(u({},m),{[w]:[...m[w]||[],v]}),{});return[c,$]}return[]},this.addTranslations=(e,t)=>{var a;if(!e)return;(a=s(this.config))!=null&&a.debug&&console.debug("[i18n]: Adding translations...");let o=Object.keys(e||{});this.privateTranslations.update(l=>o.reduce((i,n)=>h(u({},i),{[n]:u(u({},i[n]||{}),I(e[n]))}),l)),o.forEach(l=>{let i=Object.keys(e[l]).map(n=>`${n}`.split(".")[0]);t&&(i=t[l]),this.loadedKeys[l]=Array.from(new Set([...this.loadedKeys[l]||[],...i||[]]))})},this.loader=async([e,t])=>{var a;(a=s(this.config))!=null&&a.debug&&console.debug("[i18n]: Adding loader promise.");let o=(async()=>{let l=await this.getTranslationProps(e,t);l.length&&this.addTranslations(...l)})();this.promises.add({locale:e,route:t,promise:o}),o.then(()=>{let l=this.getLocale(e);l&&this.locale.get()!==l&&this.locale.forceSet(l)})},this.loadTranslations=(e,t=s(this.currentRoute)||"")=>{if(e)return this.setRoute(t),this.setLocale(e),this.loading.toPromise(e,t)},r&&this.loadConfig(r),this.loaderTrigger.subscribe(this.loader),this.isLoading.subscribe(async e=>{var t;e&&this.promises.size&&(await this.loading.toPromise(),this.promises.clear(),(t=s(this.config))!=null&&t.debug&&console.debug("[i18n]: Loader promises have been purged."))})}async configLoader(r){if(!r)throw new Error("[i18n]: No config provided!");let e=r,{initLocale:t,fallbackLocale:a,translations:o,debug:l}=e,i=D(e,["initLocale","fallbackLocale","translations","debug"]);t=f(t)[0],a=f(a)[0],l&&console.debug("[i18n]: Setting config."),this.config.set(u({initLocale:t,fallbackLocale:a,translations:o,debug:l},i)),o&&this.addTranslations(o),await this.loadTranslations(t)}},G=Object.defineProperty,pe=Object.defineProperties,fe=Object.getOwnPropertyDescriptors,V=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,z=(r,e,t)=>e in r?G(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,O=(r,e)=>{for(var t in e||(e={}))J.call(e,t)&&z(r,t,e[t]);if(V)for(var t of V(e))Q.call(e,t)&&z(r,t,e[t]);return r},X=(r,e)=>pe(r,fe(e)),j=(r,e)=>{var t={};for(var a in r)J.call(r,a)&&e.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&V)for(var a of V(r))e.indexOf(a)<0&&Q.call(r,a)&&(t[a]=r[a]);return t},he=(r,e)=>{for(var t in e)G(r,t,{get:e[t],enumerable:!0})},Y={};he(Y,{ago:()=>we,date:()=>be,eq:()=>C,gt:()=>ee,gte:()=>ve,lt:()=>Z,lte:()=>me,ne:()=>ge,number:()=>ye});var S=(r,e)=>{let{modifierDefaults:t}=e||{},{[r]:a}=t||{};return a||{}},C=({value:r,options:e=[],defaultValue:t=""})=>(e.find(({key:a})=>`${a}`.toLowerCase()===`${r}`.toLowerCase())||{}).value||t,ge=({value:r,options:e=[],defaultValue:t=""})=>(e.find(({key:a})=>`${a}`.toLowerCase()!==`${r}`.toLowerCase())||{}).value||t,Z=({value:r,options:e=[],defaultValue:t=""})=>(e.sort((a,o)=>+a.key-+o.key).find(({key:a})=>+r<+a)||{}).value||t,ee=({value:r,options:e=[],defaultValue:t=""})=>(e.sort((a,o)=>+o.key-+a.key).find(({key:a})=>+r>+a)||{}).value||t,me=({value:r,options:e=[],defaultValue:t=""})=>C({value:r,options:e,defaultValue:Z({value:r,options:e,defaultValue:t})}),ve=({value:r,options:e=[],defaultValue:t=""})=>C({value:r,options:e,defaultValue:ee({value:r,options:e,defaultValue:t})}),ye=({value:r,props:e,defaultValue:t="",locale:a="",parserOptions:o})=>{if(!a)return"";let l=S("number",o),{maximumFractionDigits:i}=l,n=j(l,["maximumFractionDigits"]),p=(e==null?void 0:e.number)||{},{maximumFractionDigits:d=i||2}=p,y=j(p,["maximumFractionDigits"]);return new Intl.NumberFormat(a,O(X(O({},n),{maximumFractionDigits:d}),y)).format(+r||+t)},be=({value:r,props:e,defaultValue:t="",locale:a="",parserOptions:o})=>{if(!a)return"";let l=j(S("date",o),[]),i=j((e==null?void 0:e.date)||{},[]);return new Intl.DateTimeFormat(a,O(O({},l),i)).format(+r||+t)},A=[{key:"second",multiplier:1e3},{key:"minute",multiplier:60},{key:"hour",multiplier:60},{key:"day",multiplier:24},{key:"week",multiplier:7},{key:"month",multiplier:13/3},{key:"year",multiplier:12}],te=(r="",e="")=>new RegExp(`^${r}s?$`).test(e),Oe=r=>A.indexOf(A.find(({key:e})=>te(e,r))),ke=(r,e)=>A.reduce(([t,a],{key:o,multiplier:l},i)=>{if(te(a,e))return[t,a];if(!a||i===Oe(a)+1){let n=Math.round(t/l);if(!a||Math.abs(n)>=1||e!=="auto")return[n,o]}return[t,a]},[r,""]),we=({value:r,defaultValue:e="",locale:t="",props:a,parserOptions:o})=>{if(!t)return"";let l=S("ago",o),{format:i,numeric:n}=l,p=j(l,["format","numeric"]),d=(a==null?void 0:a.ago)||{},{format:y=i||"auto",numeric:T=n||"auto"}=d,L=j(d,["format","numeric"]),k=+r||+e,c=ke(k,y);return new Intl.RelativeTimeFormat(t,O(X(O({},p),{numeric:T}),L)).format(...c)},Le=r=>typeof r=="string"&&/{{(?:(?!{{|}}).)+}}/.test(r),x=r=>typeof r=="string"?r.replace(/\\(?=:|;|{|})/g,""):r,$e=({value:r,props:e,payload:t,parserOptions:a,locale:o})=>`${r}`.replace(/{{\s*(?:(?!{{|}}).)+\s*}}/g,l=>{let i=x(`${l.match(/(?!{|\s).+?(?!\\[:;]).(?=\s*(?:[:;]|}}$))/)}`),n=t==null?void 0:t[i],[,p=""]=l.match(/.+?(?!\\;).;\s*default\s*:\s*([^\s:;].+?(?:\\[:;]|[^;\s}])*)(?=\s*(?:;|}}$))/i)||[];p=p||(t==null?void 0:t.default)||"";let[,d=""]=l.match(/{{\s*(?:[^;]|(?:\\;))+\s*(?:(?!\\:).[:])\s*(?!\s)((?:\\;|[^;])+?)(?=\s*(?:[;]|}}$))/i)||[];if(n===void 0&&d!=="ne")return p;let y=!!d,{customModifiers:T}=a||{},L=O(O({},Y),T||{});d=Object.keys(L).includes(d)?d:"eq";let k=L[d],c=(l.match(/[^\s:;{](?:[^;]|\\[;])+[^\s:;}]/gi)||[]).reduce((g,$,m)=>{if(m>0){let v=x(`${$.match(/(?:(?:\\:)|[^:])+/)}`.trim()),w=`${$.match(/(?:(?:\\:)|[^:])+$/)}`.trim();if(v&&v!=="default"&&w)return[...g,{key:v,value:w}]}return g},[]);return!y&&!c.length?n:k({value:n,options:c,props:e,defaultValue:p,locale:o,parserOptions:a})}),ae=({value:r,props:e,payload:t,parserOptions:a,locale:o})=>{if(Le(r)){let l=$e({value:r,payload:t,props:e,parserOptions:a,locale:o});return ae({value:l,payload:t,props:e,parserOptions:a,locale:o})}else return x(r)},_e=r=>({parse:(e,[t,a],o,l)=>((t==null?void 0:t.default)&&e===void 0&&(e=`${t.default}`),e===void 0&&(e=`${l}`),ae({value:e,payload:t,props:a,parserOptions:r,locale:o}))}),Pe=_e,je=Object.defineProperty,Te=Object.defineProperties,Ee=Object.getOwnPropertyDescriptors,R=Object.getOwnPropertySymbols,re=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,H=(r,e,t)=>e in r?je(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ve=(r,e)=>{for(var t in e||(e={}))re.call(e,t)&&H(r,t,e[t]);if(R)for(var t of R(e))oe.call(e,t)&&H(r,t,e[t]);return r},Re=(r,e)=>Te(r,Ee(e)),De=(r,e)=>{var t={};for(var a in r)re.call(r,a)&&e.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&R)for(var a of R(r))e.indexOf(a)<0&&oe.call(r,a)&&(t[a]=r[a]);return t},M=r=>{var e=r,{parserOptions:t={}}=e,a=De(e,["parserOptions"]);return Re(Ve({},a),{parser:Pe(t)})},Ae=class extends de{constructor(r){super(r&&M(r));this.loadConfig=e=>super.configLoader(M(e))}},xe=Ae,q={en:"English",ru:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439"};const Ie=[{locale:"en",key:"common",loader:async()=>(await b(()=>import("./common-0b8e2f7f.js"),[])).default},{locale:"en",key:"menu",loader:async()=>(await b(()=>import("./menu-7a945dfc.js"),[])).default},{locale:"en",key:"home",routes:["","/"],loader:async()=>(await b(()=>import("./home-346bf1d8.js"),[])).default},{locale:"en",key:"error",routes:["error"],loader:async()=>(await b(()=>import("./error-60ee6c56.js"),[])).default}],Se=[{locale:"ru",key:"common",loader:async()=>(await b(()=>import("./common-866baf95.js"),[])).default},{locale:"ru",key:"menu",loader:async()=>(await b(()=>import("./menu-3a467a3d.js"),[])).default},{locale:"ru",key:"home",routes:["","/"],loader:async()=>(await b(()=>import("./home-3dbd43c8.js"),[])).default},{locale:"ru",key:"error",routes:["error"],loader:async()=>(await b(()=>import("./error-b172b9a7.js"),[])).default}],Ce={translations:{en:{lang:q},ru:{lang:q}},loaders:[...Ie,...Se]},{t:ze,locale:He,locales:Me,loading:W,loadTranslations:qe,translations:Fe}=new xe(Ce);W.subscribe(async r=>{r&&(console.log("Loading translations..."),await W.toPromise(),console.log("Updated translations",Fe.get()))});export{qe as a,He as l,ze as t};
